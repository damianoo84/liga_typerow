{% extends 'base.html.twig' %}

{% block content %}
    
        <table>
            <tr>
                <th>Opis</th>
                <th>Gospodarz</th>
                <th></th>
                <th></th>
                <th></th>
                <th>Gość</th>
                <th>Termin</th>
            </tr>
            
            {% if (is_typed(curr_matchday().id, app.user.id)) == true %}
                
                {% for key,type in types %}
                    <tr>          
                        <td class="desc">{{ type.league }}</td>
                        <td>{{ type.host }}</td>
                        <td>{{ type.hostType }}</td>
                        <td>-</td>
                        <td>{{ type.guestType }}</td>
                        <td>{{ type.guest }}</td>
                        <td class="term">{{ type.term }}</td>
                    </tr>
                {% endfor %}
                
            {% else %}
                
                <form id="form">
                {% for key,meet in meets %}
                    <tr>
                        <input type="hidden" name="meet_id[]" value="{{ meet.meet_id }}">           
                        <td class="desc">{{ meet.league }}</td>
                        <td>{{ meet.host }}</td>
                        <td><input type="text" class="tp" name="hostType[]" maxlength='1'></td>
                        <td>-</td>
                        <td><input type="text" class="tp" name="guestType[]" maxlength='1'></td>
                        <td>{{ meet.guest }}</td>
                        <td class="term">{{ meet.term }}</td>
                    </tr>
                {% endfor %}
                    <tr><input type="submit"  value="Wyślij"  class="space"/></tr>
                </form>
                
            {% endif %}
            
        </table>
            
        
                
        <script type="text/javascript">
            $(function(){
               $("#form").submit(function(e){
                    var form=$(this);
                    $.ajax({
                        url:"{{ path('liga_typerow_types') }}",
                        dataType:"JSON",
                        type:"POST",
                        data:form.serialize(),
                        success:function(){
                            form.get(0).reset();
                            console.log("jest ok");
                            location.reload();
                        },
                        error: function() {
                            console.log("Wystąpił błąd");
                        }
                    });
                    e.preventDefault();
                });
            });
        </script>
{% endblock %}